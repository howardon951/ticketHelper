# Tampermonkey 半自動化輔助腳本開發文件

## 1. 文件目的與定位

本文件用於說明 **Tampermonkey 使用者腳本** 在票務／表單類網站中的**合理使用方式與設計結構**，目標是：

- 提高操作效率
- 降低人為失誤
- 保持合規與可控風險

> **本文件不包含任何全自動搶票、繞過平台防護或 API 逆向行為。**

---

## 2. Tampermonkey 的正確定位

Tampermonkey 腳本的核心定位如下：

> **不是用來搶票**
> **而是用來減少人為浪費時間**

### 2.1 合法且建議的腳本目標

- ✅ 表單資料預填
- ✅ 操作焦點與視覺提示
- ✅ 狀態顯示（時間、倒數、流程）
- ✅ 人類操作節奏輔助

### 2.2 明確禁止的行為範圍

- ❌ 全自動下單
- ❌ 高頻或無限刷新
- ❌ 模擬或直接呼叫後端 API

---

## 3. 腳本整體架構設計（模組化）

建議採用**模組化設計**，每個模組功能單一、可獨立測試。

---

### 模組 1：環境與頁面判斷（必要）

#### 功能目標

- 確認目前頁面狀態
- 確保 DOM 與必要元素已可操作

#### 需要判斷的項目

- 當前 URL / 頁面類型
- DOM 是否完成渲染
- 目標元素是否存在

#### 設計原則

- 不假設 DOM 在載入瞬間可用
- 必須等待元素出現（輪詢或 Observer）

> 此模組可避免「點不到元素」或「在錯誤頁面執行腳本」

---

### 模組 2：資料預填（安全性最高）

#### 可預填欄位

- 姓名
- 電話
- Email
- 身分證字號
- 常用選項（張數、區域等）

#### 強制原則

- 僅填寫欄位值
- 不觸發送出事件
- 不自動勾選最終確認

> 此模組屬於低風險、高回報功能

---

### 模組 3：狀態與提示顯示（強烈建議）

#### 顯示內容

- 當前時間
- 距離開賣時間倒數
- 腳本狀態（等待中 / 已就緒 / 可操作）

#### 實作方式

- `console.log`
- 或建立浮動 UI 元件（overlay）

> 目的是降低誤操作與焦慮，而非加速行為

---

### 模組 4：人類操作節奏輔助（加分項）

#### 可提供功能

- 一鍵聚焦到主要操作區
- 自動捲動至購買區塊
- 高亮目前應操作的按鈕

#### 限制原則

- 所有關鍵點擊由使用者執行
- 腳本僅負責「準備環境」

---

### 模組 5：安全與風控保護機制（必做）

#### 必須遵守

- ❌ 禁用無限 `setInterval`
- ❌ 禁用毫秒級循環
- ✅ 設定 timeout 與最大嘗試次數
- ✅ 提供手動啟動 / 停用開關
- ✅ 可快速停用整個腳本

> **可控性 = 風控友善**

---

## 4. 實戰開發經驗與最佳實務

### 4.1 等待「元素出現」而非固定延遲

```js
// 等到元素存在再執行動作
```

優於：

```js
setTimeout(() => {}, 1000);
```

原因：

- 不依賴網速假設
- 降低錯誤與異常行為

---

### 4.2 行為節奏應「慢且不完美」

- 偶爾加入 200–500ms 停頓
- 避免完全一致的操作節奏
- 避免頁面一載入即大量動作

> **穩定性優先於速度**

---

### 4.3 腳本必須可觀測、可除錯

- 每個步驟都有 `console.log`
- 發生錯誤時可立即定位模組

> Debug 能力直接影響長期可用性

---

## 5. 推薦執行流程（文字流程圖）

```
進入頁面
  ↓
等待 DOM ready
  ↓
顯示狀態面板
  ↓
執行資料預填
  ↓
等待使用者操作
  ↓
腳本僅提供提示與聚焦
```

### 此流程的優點

- 合規
- 行為自然
- 維護成本低
- 可長期重複使用

---

## 6. 後續開發方向（擇一）

1. Tampermonkey 腳本骨架模板（不含業務邏輯）
2. 特定網站適用性與風險評估
3. 倒數計時＋預填＋高亮提示的完整設計

---

> 你已經選擇了正確的技術路線
> 接下來需要的不是冒險，而是結構化實作
